---
title: "Week2"
author: "Lisa Wahlen"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Task 1: import Data

Create a new R- (or RMarkdown/Quarto-) file and begin with the following lines of code (adjust the path to your csv file accordingly).

### load the libraries

```{r}
library(readr) # to import tabular data (e.g. csv)
library(dplyr) # to manipulate (tabular) data
library(ggplot2) # to visualize data
library(sf) # to handle spatial vector data
library(terra) # To handle raster data
library(lubridate) # To handle dates and times
```

### Import the downloaded csv

```{r}
wildschwein_BE <- read_delim("data/wildschwein_BE_2056.csv", ",")

wildschwein_BE <- st_as_sf(wildschwein_BE, coords = c("E", "N"), crs = 2056, remove = FALSE)
```

Note:

-   that this dataset is already converted to EPSG 2056

-   the coordinates are stored in the columns (`E`/`N`)

-   setting `remove = FALSE` preserves the original (`E`/`N`) columns, which come in handy later on

## Task 2: Getting an overview

Calculate the time difference between subsequent rows as described in the demo. You can calculate the time difference using the function `difftime()` in combination with `lead()`.

-   the function `difftime()` has an option `units`. Set this to `secs` to get the time difference in seconds

-   use `as.integer()` to turn the output returned by `difftime()` into an integer.

-   store the output in a new column (e.g. `timelag`)

```{r}
wildschwein_diff <- wildschwein_BE |> 
  group_by(TierName) |> 
  mutate(time_diff = as.integer(difftime(DatetimeUTC, lag(DatetimeUTC, n = 1, default = NA, order_by = DatetimeUTC), units = "secs")))
```

Now inspect your data in more detail. Try to answer the following questions:

-   How many individuals were tracked?

```{r}
count <- wildschwein_BE |> 
  group_by(TierName) |> 
  summarise(total_count = n())
```

-   For how long were the individual tracked? Are there gaps?

```{r}
ggplot(wildschwein_BE, aes(DatetimeUTC, TierID)) + 
  geom_line()
```

-   Were all individuals tracked concurrently or sequentially?

-   What is the temporal sampling interval between the locations?

```{r}
ggplot(wildschwein_diff, aes(DatetimeUTC, time_diff, color=TierName)) +
  geom_line() +
  geom_point()
```

Here are some exemplary visualisation you could produce to answer these questions. Can you now answer the above questions?

After completing the task, commit your changes to git using a good commit message (e.g. `completed task 1`).
